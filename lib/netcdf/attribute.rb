#======================================================================================
#
#======================================================================================

class NetCDF

  #------------------------------------------------------------------------------------
  # An Attribute has a name and a value, used for associating arbitrary metadata with 
  # a Variable or a Group. The value can be a one dimensional array of Strings or 
  # numeric values.
  # Attributes are immutable.
  #------------------------------------------------------------------------------------

  class Attribute

    attr_reader :netcdf_attribute
    
    #------------------------------------------------------------------------------------
    #
    #------------------------------------------------------------------------------------

    def initialize(name, val)

      value = val
      if (val.is_a? Fixnum)
        value = val.to_java(:int)
      elsif (val.is_a? Array)
        value = Array.new
        val.each do |elmt|
          if (elmt.is_a? Fixnum)
            value << elmt.to_java(:int)
          else
            value << elmt
          end
        end
      end
      att = Java::UcarNc2::Attribute.new(name, value)
      @netcdf_attribute = att

    end

    #------------------------------------------------------------------------------------
    #
    #------------------------------------------------------------------------------------

    def data_type
      @netcdf_attribute.getDataType().toString()
    end

    #------------------------------------------------------------------------------------
    #
    #------------------------------------------------------------------------------------

    def length
      @netcdf_attribute.getLength()
    end

    #------------------------------------------------------------------------------------
    #
    #------------------------------------------------------------------------------------

    def name
      @netcdf_attribute.getName()
    end

    #------------------------------------------------------------------------------------
    #
    #------------------------------------------------------------------------------------

    def numeric_value(index = 0)
      @netcdf_attribute.getNumericValue(index)
    end

    #------------------------------------------------------------------------------------
    #
    #------------------------------------------------------------------------------------

    def string_value
      @netcdf_attribute.getStringValue()
    end

    #------------------------------------------------------------------------------------
    #
    #------------------------------------------------------------------------------------

    def value
      @netcdf_attribute.getValue()
    end

    #------------------------------------------------------------------------------------
    #
    #------------------------------------------------------------------------------------

    def string?
      @netcdf_attribute.isString()
    end

    #------------------------------------------------------------------------------------
    #
    #------------------------------------------------------------------------------------

    def unsigned?
      @netcdf_attribute.isUnsigned()
    end

    #------------------------------------------------------------------------------------
    #
    #------------------------------------------------------------------------------------

    def to_string(strict = false)
      @netcdf_attribute.toString(strict)
    end

  end # Attribute

end


